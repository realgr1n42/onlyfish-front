"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[23619],{515015:function(t,e,n){n.d(e,{U:function(){return V},y:function(){return q}});var r=n(690853),a=n(65836),s;function o(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function i(t,e,n=1/0,r=0){return t?t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:i(t.parentNode,e,n,r+1):-1}function c(t,e){return n=>{const r=n;if(null===r)return!1;try{if(t)if("string"==typeof t){if(r.matches(`.${t}`))return!0}else if(o(r,t))return!0;return!(!e||!r.matches(e))}catch(a){return!1}}}!function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"}(s||(s={}));const u="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let f={map:{},getId(){return console.error(u),-1},getNode(){return console.error(u),null},removeNodeFromMap(){console.error(u)},has(){return console.error(u),!1},reset(){console.error(u)}};function p(t,e,n,r,a=window){const s=a.Object.getOwnPropertyDescriptor(t,e);return a.Object.defineProperty(t,e,r?n:{set(t){b((()=>{n.set.call(this,t)}),0),s&&s.set&&s.set.call(this,t)}}),()=>p(t,e,s||{},!0)}function h(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],a=n(r);return"function"==typeof a&&(a.prototype=a.prototype||{},Object.defineProperties(a,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=a,()=>{t[e]=r}}catch(r){return()=>{}}}function l(t){if(!t)return null;const e=undefined;return t.nodeType===t.ELEMENT_NODE?t:t.parentElement}function d(t,e,n,r,a){if(!t)return!1;const s=l(t);if(!s)return!1;const o=c(e,n);if(!a){const t=r&&s.matches(r);return o(s)&&!t}const u=i(s,o);let f=-1;return!(u<0)&&(r&&(f=i(s,c(null,r))),u>-1&&f<0||u<f)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(f=new Proxy(f,{get(t,e,n){return"map"===e&&console.error(u),Reflect.get(t,e,n)}})),/[1-9][0-9]{12}/.test(Date.now().toString());const m={};function g(t){const e=m[t];if(e)return e;const n=window.document;let r=window[t];if(n&&"function"==typeof n.createElement)try{const e=n.createElement("iframe");e.hidden=!0,n.head.appendChild(e);const a=e.contentWindow;a&&a[t]&&(r=a[t]),n.head.removeChild(e)}catch(a){}return m[t]=r.bind(window)}function y(...t){return g("requestAnimationFrame")(...t)}function b(...t){return g("setTimeout")(...t)}var v=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(v||{});let w;function C(t){w=t}const M=t=>{if(!w)return t;const e=undefined;return(...e)=>{try{return t(...e)}catch(n){if(w&&!0===w(n))return()=>{};throw n}}};for(var L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O="undefined"==typeof Uint8Array?[]:new Uint8Array(256),x=0;x<64;x++)O[L.charCodeAt(x)]=x;var A=function(t){var e=new Uint8Array(t),n,r=e.length,a="";for(n=0;n<r;n+=3)a+=L[e[n]>>2],a+=L[(3&e[n])<<4|e[n+1]>>4],a+=L[(15&e[n+1])<<2|e[n+2]>>6],a+=L[63&e[n+2]];return r%3==2?a=a.substring(0,a.length-1)+"=":r%3==1&&(a=a.substring(0,a.length-2)+"=="),a};const S=new Map;function _(t,e){let n=S.get(t);return n||(n=new Map,S.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}const R=(t,e,n)=>{if(!t||!I(t,e)&&"object"!=typeof t)return;const r=undefined,a=_(n,t.constructor.name);let s=a.indexOf(t);return-1===s&&(s=a.length,a.push(t)),s};function D(t,e,n){if(t instanceof Array)return t.map((t=>D(t,e,n)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray){const e=undefined;return{rr_type:t.constructor.name,args:[Object.values(t)]}}if(t instanceof ArrayBuffer){const e=undefined,n=undefined;return{rr_type:t.constructor.name,base64:A(t)}}if(t instanceof DataView){const r=undefined;return{rr_type:t.constructor.name,args:[D(t.buffer,e,n),t.byteOffset,t.byteLength]}}if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:n}=t;return{rr_type:e,src:n}}if(t instanceof HTMLCanvasElement){const e=undefined,n=undefined;return{rr_type:"HTMLImageElement",src:t.toDataURL()}}if(t instanceof ImageData){const r=undefined;return{rr_type:t.constructor.name,args:[D(t.data,e,n),t.width,t.height]}}if(I(t,e)||"object"==typeof t){const r=undefined,a=undefined;return{rr_type:t.constructor.name,index:R(t,e,n)}}return t}const E=(t,e,n)=>t.map((t=>D(t,e,n))),I=(t,e)=>{const n=undefined,r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(r.find((n=>t instanceof e[n])))};function k(t,e,n,r,a){const s=[],o=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const c of o)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[c])continue;const o=h(e.CanvasRenderingContext2D.prototype,c,(function(s){return function(...o){return d(this.canvas,n,r,a,!0)||b((()=>{const n=E(o,e,this);t(this.canvas,{type:v["2D"],property:c,args:n})}),0),s.apply(this,o)}}));s.push(o)}catch(i){const n=p(e.CanvasRenderingContext2D.prototype,c,{set(e){t(this.canvas,{type:v["2D"],property:c,args:[e],setter:!0})}});s.push(n)}return()=>{s.forEach((t=>t()))}}function U(t){return"experimental-webgl"===t?"webgl":t}function T(t,e,n,r,a){const s=[];try{const o=h(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(s,...o){if(!d(this,e,n,r,!0)){const t=U(s);if("__context"in this||(this.__context=t),a&&["webgl","webgl2"].includes(t))if(o[0]&&"object"==typeof o[0]){const t=o[0];t.preserveDrawingBuffer||(t.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[s,...o])}}));s.push(o)}catch(o){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach((t=>t()))}}function W(t,e,n,r,a,s,o,i){const c=[],u=Object.getOwnPropertyNames(t);for(const l of u)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(l))try{if("function"!=typeof t[l])continue;const o=h(t,l,(function(t){return function(...o){const c=t.apply(this,o);if(R(c,i,this),"tagName"in this.canvas&&!d(this.canvas,r,a,s,!0)){const t=E(o,i,this),r={type:e,property:l,args:t};n(this.canvas,r)}return c}}));c.push(o)}catch(f){const r=p(t,l,{set(t){n(this.canvas,{type:e,property:l,args:[t],setter:!0})}});c.push(r)}return c}function B(t,e,n,r,a,s){const o=[];return o.push(...W(e.WebGLRenderingContext.prototype,v.WebGL,t,n,r,a,s,e)),void 0!==e.WebGL2RenderingContext&&o.push(...W(e.WebGL2RenderingContext.prototype,v.WebGL2,t,n,r,a,s,e)),()=>{o.forEach((t=>t()))}}var F='for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};';function G(){const t=new Blob([F]);return URL.createObjectURL(t)}class P{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(t,e)=>{const n=undefined;!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)};const{sampling:e="all",win:n,blockClass:r,blockSelector:a,unblockSelector:s,maxCanvasSize:o,recordCanvas:i,dataURLOptions:c,errorHandler:u}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,this.options=t,u&&C(u),t.enableManualSnapshot||M((()=>{i&&"all"===e&&this.initCanvasMutationObserver(n,r,a,s),i&&"number"==typeof e&&this.initCanvasFPSObserver(e,n,r,a,s,o,{dataURLOptions:c})}))()}initCanvasFPSObserver(t,e,n,r,a,s,o){const i=T(e,n,r,a,!0),c=this.takeSnapshot(!1,t,e,n,r,a,s,o.dataURLOptions);this.resetObservers=()=>{i(),cancelAnimationFrame(c)}}initCanvasMutationObserver(t,e,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const a=T(t,e,n,r,!1),s=k(this.processMutation.bind(this),t,e,n,r),o=B(this.processMutation.bind(this),t,e,n,r,this.mirror);this.resetObservers=()=>{a(),s(),o()}}snapshot(t){const{options:e}=this,n=this.takeSnapshot(!0,"all"===e.sampling?2:e.sampling||2,e.win,e.blockClass,e.blockSelector,e.unblockSelector,e.maxCanvasSize,e.dataURLOptions,t);this.resetObservers=()=>{cancelAnimationFrame(n)}}takeSnapshot(t,e,n,a,s,o,i,c,u){const f=new Map,p=new Worker(G());p.onmessage=t=>{const e=t.data,{id:n}=e;if(f.set(n,!1),!("base64"in e))return;const{base64:r,type:a,width:s,height:o}=e;this.mutationCb({id:n,type:v["2D"],commands:[{property:"clearRect",args:[0,0,s,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:a}]},0,0,s,o]}]})};const h=1e3/e;let l=0,m;const g=t=>{if(t)return[t];const e=[];return n.document.querySelectorAll("canvas").forEach((t=>{d(t,a,s,o,!0)||e.push(t)})),e},b=e=>{l&&e-l<h||(l=e,g(u).forEach((e=>{const n=this.mirror.getId(e);if(!f.get(n)&&e.width&&e.height){if(f.set(n,!0),!t&&["webgl","webgl2"].includes(e.__context)){const t=e.getContext(e.__context);!1===(0,r.z)([t,"optionalAccess",t=>t.getContextAttributes,"call",t=>t(),"optionalAccess",t=>t.preserveDrawingBuffer])&&t.clear(t.COLOR_BUFFER_BIT)}createImageBitmap(e).then((t=>{p.postMessage({id:n,bitmap:t,width:e.width,height:e.height,dataURLOptions:c,maxCanvasSize:i},[t])})).catch((t=>{M((()=>{throw t}))()}))}}))),m=y(b)};return m=y(b),m}startPendingCanvasMutationFlusher(){y((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,y(t)};y(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{const n=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,n)})),y((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||-1===e)return;const r=n.map((t=>{const{type:e,...n}=t;return n})),{type:a}=n[0];this.mutationCb({id:e,type:a,commands:r}),this.pendingCanvasMutations.delete(t)}}const z={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},j="ReplayCanvas",N=1280,H=(t={})=>{const[e,n]=t.maxCanvasSize||[],r={quality:t.quality||"medium",enableManualSnapshot:t.enableManualSnapshot,maxCanvasSize:[e?Math.min(e,N):N,n?Math.min(n,N):N]};let a;const s=new Promise((t=>a=t));return{name:j,setupOnce(){},getOptions(){const{quality:t,enableManualSnapshot:e,maxCanvasSize:n}=r;return{enableManualSnapshot:e,recordCanvas:!0,getCanvasManager:t=>{const r=new P({...t,enableManualSnapshot:e,maxCanvasSize:n,errorHandler:t=>{try{"object"==typeof t&&(t.__rrweb__=!0)}catch(e){}}});return a(r),r},...z[t||"medium"]||z.medium}},async snapshot(t){const e=undefined;(await s).snapshot(t)}}},q=(0,a._C)(H),V=(0,a.F)(j,q)}}]);